<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="Mac 68K emulator,680x0,68LC040,API,Apple Macintosh,Classic (Mac OS X),Connectix,Dynamic recompilation,Emulator,Eric Traut,Instruction set" />
<link rel="shortcut icon"  />
<link rel="search" type="application/opensearchdescription+xml"  />
<link rel="copyright"  />
		<title>Mac 68K emulator - Wikipedia, the free encyclopedia</title>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "/skins-1.5/monobook/main.css?9"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print"  />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins-1.5/monobook/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/skins-1.5/monobook/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/skins-1.5/monobook/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/skins-1.5/monobook/IE70Fixes.css?1";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">
			var skin = "monobook";
			var stylepath = "/skins-1.5";

			var wgArticlePath = "/wiki/$1";
			var wgScriptPath = "/w";
			var wgServer = "http://en.wikipedia.org";
                        
			var wgCanonicalNamespace = "";
			var wgNamespaceNumber = 0;
			var wgPageName = "Mac_68K_emulator";
			var wgTitle = "Mac 68K emulator";
			var wgArticleId = 291466;
			var wgIsArticle = true;
                        
			var wgUserName = null;
			var wgUserLanguage = "en";
			var wgContentLanguage = "en";
		</script>
		                
		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?1"><!-- wikibits js --></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
@import "/w/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
@import "/w/index.php?title=-&action=raw&gen=css&maxage=2678400";
/*]]>*/</style>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js"></script>
	</head>
<body  class="mediawiki ns-0 ltr">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><div style="text-align:right; font-size:80%">Your <b><a  class="extiw" title="wikimedia:Fundraising">continued donations</a></b> keep Wikipedia running!&nbsp;&nbsp;&nbsp;&nbsp;</div>
</div>		<h1 class="firstHeading">Mac 68K emulator</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a >navigation</a>, <a >search</a></div>			<!-- start content -->
			<p>The <b>Mac 68K emulator</b> was a <a href="/wiki/Software.html" title="Software">software</a> <a href="/wiki/Emulator.html" title="Emulator">emulator</a> built into all versions of the <a href="/wiki/Mac_OS.html" title="Mac OS">Mac OS</a> for <a href="/wiki/PowerPC.html" title="PowerPC">PowerPC</a>. This emulator permitted the running of applications and system code that were originally written for the <a href="/wiki/680x0.html" title="680x0">680x0</a> based <a href="/wiki/Apple_Macintosh.html" title="Apple Macintosh">Macintosh</a> models. The emulator was completely seamless for users, and reasonably seamless for <a href="/wiki/Programmer.html" title="Programmer">programmers</a>. It is thought that this aspect of the Mac OS is the first time that such a dual hardware architecture <a href="/wiki/Operating_system.html" title="Operating system">operating system</a> had ever been successfully implemented. It was primarily developed by <a href="/wiki/Eric_Traut.html" title="Eric Traut">Eric Traut</a>, who later worked on successful emulation projects such as <a href="/wiki/Connectix.html" title="Connectix">Connectix</a> <a href="/wiki/Virtual_Game_Station.html" title="Virtual Game Station">Virtual Game Station</a> and <a href="/wiki/Microsoft.html" title="Microsoft">Microsoft</a> <a href="/wiki/Virtual_PC.html" title="Virtual PC">Virtual PC</a>.</p>
<p>All versions of this emulator emulated the <a href="/wiki/68LC040.html" title="68LC040">68LC040</a> chip <a href="/wiki/Instruction_set.html" title="Instruction set">instruction set</a>. Early versions emulated it in a simple fashion where each instruction was carried out by a series of equivalent PowerPC instructions. Later, a <a href="/wiki/Dynamic_recompilation.html" title="Dynamic recompilation">dynamic recompilation</a> emulator was used, to boost performance. This worked by "recompiling" common sections of 680x0 code into faster sequences that were locally cached. The emulator could recognise the same sequence of 680x0 code, and run the previously cached code to avoid doing the translation again. This emulator was capable of emulating the 68LC040 faster than any real 68LC040 was capable of running.</p>
<p>One reason that this emulation was so successful is that many of the <a href="/wiki/API.html" title="API">APIs</a> for the Mac OS were originally implemented as traps on the 680x0 processor - calling an API actually was recognised by the 680x0 as an error condition, which would cause it to handle that error through one of its hardware vectors, which in turn would look up and run the operating system routine from ROM or RAM. In the emulator, such traps could be replaced by native PowerPC code, so the only code being emulated was the application itself - any system API it called could be accelerated with native PowerPC code. It also allowed Apple time to port the OS to the PowerPC - at first only time critical aspects were rewritten in native code, leaving much of the OS emulated. Gradually most of the OS was rewritten to be native, so the OS got faster over time.</p>
<p>For the programmer, the transition to the PowerPC was made fairly painless, as the emulator was started and stopped automatically. This was achieved using a new type of <a href="/wiki/Pointer.html" title="Pointer">pointer</a> called a Universal Procedure Pointer (UPP). For 68k code, this pointer was just an ordinary pointer - such code would already be running on the emulator so a call to another piece of 68k code via a pointer just continued as normal. This backwards compatibility with existing object code was vital to the success of the scheme. For PowerPC code, or 68k code calling PowerPC code, the pointer actually led to a special data structure, which contained a special trap instruction and flags indicating the instruction set architecture (ISA) of both the caller and called code, and could be passed to the CallUniversalProc() function to trigger actual execution. CallUniversalProc() then dealt with details such as presenting passed parameters in the right order for the ISA in question, as well as starting and stopping the emulator as required. The compilers for Mac OS created such UPPs automatically when the proper <a href="/wiki/Macro.html" title="Macro">macros</a> were used, and the PowerPC system libraries contained native stubs to transparently call through to native or still-68k functions as needed, so dealing with the dual architecture required very little work for the programmer. And just like the OS, applications themselves could mix and match 680x0 and PowerPC code fairly easily.</p>
<p>The emulator is no longer part of <a href="/wiki/Mac_OS_X.html" title="Mac OS X">Mac OS X</a>, though it remains as an integral part of the <a href="/wiki/Classic_%28Mac_OS_X%29.html" title="Classic (Mac OS X)">Classic environment</a>.</p>


<!-- Saved in parser cache with key enwiki:pcache:idhash:291466-0!1!0!default!!en!2 and timestamp 20060909163721 -->
<div class="printfooter">
Retrieved from "<a </div>
			<div id="catlinks"><p class='catlinks'><a  title="Special:Categories">Categories</a>: <span dir='ltr'><a  title="Category:Mac OS">Mac OS</a></span> | <span dir='ltr'><a  title="Category:Mac OS emulation software">Mac OS emulation software</a></span></p></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<ul>
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/Mac_68K_emulator.html">Article</a></li>
				 <li id="ca-talk"><a >Discussion</a></li>
				 <li id="ca-edit"><a >Edit this page</a></li>
				 <li id="ca-history"><a >History</a></li>
		</ul>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a >Sign in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/images/wiki-en.png);" href="/wiki/Main_Page.html" title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="/wiki/Main_Page.html">Main Page</a></li>
				<li id="n-portal"><a >Community Portal</a></li>
				<li id="n-Featured-articles"><a >Featured articles</a></li>
				<li id="n-currentevents"><a >Current events</a></li>
				<li id="n-recentchanges"><a >Recent changes</a></li>
				<li id="n-randompage"><a >Random article</a></li>
				<li id="n-help"><a >Help</a></li>
				<li id="n-contact"><a >Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a >Donations</a></li>
			</ul>
		</div>
	</div>
		<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/wiki/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a >What links here</a></li>
				<li id="t-recentchangeslinked"><a >Related changes</a></li>
<li id="t-upload"><a >Upload file</a></li>
<li id="t-specialpages"><a >Special pages</a></li>
				<li id="t-print"><a >Printable version</a></li>				<li id="t-permalink"><a >Permanent link</a></li><li id="t-cite"><a >Cite this article</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a ><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="MediaWiki" /></a></div>
				<div id="f-copyrightico"><a ><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
				<li id="lastmod"> This page was last modified 02:43, 9 May 2006.</li>
				<li id="copyright">All text is available under the terms of the <a class='internal'  title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal'  title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the Wikimedia Foundation, Inc.<br /></li>
				<li id="privacy"><a  title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li id="about"><a  title="Wikipedia:About">About Wikipedia</a></li>
				<li id="disclaimer"><a  title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
		
	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served by srv70 in 0.074 secs. --></body></html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="Windows API,.NET Framework,.NET Framework 3.0,16-bit,32-bit,64-bit,AMD64,Application framework,Application programming interface,Application software,Architecture of the Windows NT operating system line" />
<link rel="shortcut icon"  />
<link rel="search" type="application/opensearchdescription+xml"  />
<link rel="copyright"  />
		<title>Windows API - Wikipedia, the free encyclopedia</title>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "/skins-1.5/monobook/main.css?9"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print"  />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins-1.5/monobook/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/skins-1.5/monobook/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/skins-1.5/monobook/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/skins-1.5/monobook/IE70Fixes.css?1";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">
			var skin = "monobook";
			var stylepath = "/skins-1.5";

			var wgArticlePath = "/wiki/$1";
			var wgScriptPath = "/w";
			var wgServer = "http://en.wikipedia.org";
                        
			var wgCanonicalNamespace = "";
			var wgNamespaceNumber = 0;
			var wgPageName = "Windows_API";
			var wgTitle = "Windows API";
			var wgArticleId = 81601;
			var wgIsArticle = true;
                        
			var wgUserName = null;
			var wgUserLanguage = "en";
			var wgContentLanguage = "en";
		</script>
		                
		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?1"><!-- wikibits js --></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
@import "/w/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
@import "/w/index.php?title=-&action=raw&gen=css&maxage=2678400";
/*]]>*/</style>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js"></script>
	</head>
<body  class="mediawiki ns-0 ltr">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><div style="text-align:right; font-size:80%">Your <b><a  class="extiw" title="wikimedia:Fundraising">continued donations</a></b> keep Wikipedia running!&nbsp;&nbsp;&nbsp;&nbsp;</div>
</div>		<h1 class="firstHeading">Windows API</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub">(Redirected from <a  title="WinAPI">WinAPI</a>)</div>
									<div id="jump-to-nav">Jump to: <a >navigation</a>, <a >search</a></div>			<!-- start content -->
			<p>The <b>Windows API</b>, informally <b>WinAPI</b>, is the name given by Microsoft to the core set of <a href="/wiki/Application_programming_interface.html" title="Application programming interface">application programming interfaces</a> available in the <a href="/wiki/Microsoft_Windows.html" title="Microsoft Windows">Microsoft Windows</a> <a href="/wiki/Operating_systems.html" title="Operating systems">operating systems</a>. It is designed for usage by <a href="/wiki/C_programming_language.html" title="C programming language">C</a>/<a href="/wiki/C%2B%2B.html" title="C++">C++</a> programs and is the most direct way to interact with a Windows system for <a href="/wiki/Application_software.html" title="Application software">software applications</a>. Lower level access to a Windows system, mostly required for <a href="/wiki/Device_driver.html" title="Device driver">device drivers</a>, is provided by the <a href="/wiki/Native_API.html" title="Native API">Native API</a> in current versions of Windows.</p>
<p>A <a href="/wiki/Software_development_kit.html" title="Software development kit">software development kit</a> (SDK) is available for Windows, which provides documentation and tools to enable developers to create software using the Windows API and associated Windows technologies.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a ><span class="tocnumber">1</span> <span class="toctext">Overview of the Windows API Components</span></a>
<ul>
<li class="toclevel-2"><a ><span class="tocnumber">1.1</span> <span class="toctext">Web related APIs</span></a></li>
<li class="toclevel-2"><a ><span class="tocnumber">1.2</span> <span class="toctext">Multimedia related APIs</span></a></li>
<li class="toclevel-2"><a ><span class="tocnumber">1.3</span> <span class="toctext">APIs for interaction between programs</span></a></li>
<li class="toclevel-2"><a ><span class="tocnumber">1.4</span> <span class="toctext">Wrapper Libraries</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a ><span class="tocnumber">2</span> <span class="toctext">History</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">3</span> <span class="toctext">Versions</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">4</span> <span class="toctext">Other implementations</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">5</span> <span class="toctext">Compiler support</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">7</span> <span class="toctext">Notes</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">8</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">9</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<p><script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script></p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Overview of the Windows API Components">edit</a>]</div>
<p><a name="Overview_of_the_Windows_API_Components" id="Overview_of_the_Windows_API_Components"></a></p>
<h2>Overview of the Windows API Components</h2>
<p>The functionality provided by the Windows API can be grouped into seven categories:<sup id="_ref-msdn-overview_0" class="reference"><a  title="">[1]</a></sup></p>
<dl>
<dt>Base Services<sup id="_ref-msdn-base_0" class="reference"><a  title="">[2]</a></sup></dt>
<dd>Provide access to the fundamental resources available to a Windows system. Included are things like <a href="/wiki/File_systems.html" title="File systems">file systems</a>, <a  class="new" title="Category:Computer device">devices</a>, <a href="/wiki/Process_%28computing%29.html" title="Process (computing)">processes</a> and <a href="/wiki/Thread_%28computer_science%29.html" title="Thread (computer science)">threads</a>, access to the <a href="/wiki/Windows_registry.html" title="Windows registry">Windows registry</a>, and <a href="/wiki/Error_handling.html" title="Error handling">error handling</a>. These functions reside in <tt>kernel.exe</tt>, <tt>krnl286.exe</tt> or <tt>krnl386.exe</tt> files on 16-bit Windows, and <tt>kernel32.dll</tt> and <tt>advapi32.dll</tt> on 32-bit Windows.</dd>
<dt>Graphics Device Interface<sup id="_ref-msdn-gdi_0" class="reference"><a  title="">[3]</a></sup></dt>
<dd>Provide the functionality for outputting graphical content to <a href="/wiki/Computer_display.html" title="Computer display">monitors</a>, <a href="/wiki/Printers.html" title="Printers">printers</a> and other <a href="/wiki/Output_devices.html" title="Output devices">output devices</a>. It resides in <tt>gdi.exe</tt> on 16-bit Windows, and <tt>gdi32.dll</tt> on 32-bit Windows.</dd>
<dt>User Interface<sup id="_ref-msdn-ui_0" class="reference"><a  title="">[4]</a></sup></dt>
<dd>Provides the functionality to create and manage screen <a href="/wiki/Window_%28computing%29.html" title="Window (computing)">windows</a> and most basic controls, such as <a href="/wiki/Button_%28computing%29.html" title="Button (computing)">buttons</a> and <a href="/wiki/Scrollbar.html" title="Scrollbar">scrollbars</a>, receive mouse and keyboard input, and other functionality associated with the <a href="/wiki/GUI.html" title="GUI">GUI</a> part of Windows. This functional unit resides in <tt>user.exe</tt> on 16-bit Windows, and <tt>user32.dll</tt> on 32-bit Windows. Since <a href="/wiki/Windows_XP.html" title="Windows XP">Windows XP</a> versions, the basic controls reside in <tt>comctl32.dll</tt>, together with the common controls (Common Control Library).</dd>
<dt>Common Dialog Box Library<sup id="_ref-msdn-comdlg_0" class="reference"><a  title="">[5]</a></sup></dt>
<dd>Provides applications the standard <a href="/wiki/Dialog_box.html" title="Dialog box">dialog boxes</a> for opening and saving files, choosing color and font, etc. The library resides in a file called <tt>commdlg.dll</tt> on 16-bit Windows, and <tt>comdlg32.dll</tt> on 32-bit Windows. It is grouped under the <i>User Interface</i> category of the API.</dd>
<dt>Common Control Library<sup id="_ref-msdn-ccl_0" class="reference"><a  title="">[6]</a></sup></dt>
<dd>Gives applications access to some advanced controls provided by the operating system. These include things like <a href="/wiki/Status_bar.html" title="Status bar">status bars</a>, progress bars, <a href="/wiki/Toolbar.html" title="Toolbar">toolbars</a> and <a href="/wiki/Tab_%28GUI%29.html" title="Tab (GUI)">tabs</a>. The library resides in a <a href="/wiki/Dynamic-Link_Library.html" title="Dynamic-Link Library">DLL</a> file called <tt>commctrl.dll</tt> on 16-bit Windows, and <tt>comctl32.dll</tt> on 32-bit Windows. It is grouped under the <i>User Interface</i> category of the API.</dd>
<dt>Windows Shell<sup id="_ref-msdn-shell_0" class="reference"><a  title="">[7]</a></sup><sup id="_ref-msdn-shell2_0" class="reference"><a  title="">[8]</a></sup></dt>
<dd>Component of the Windows API allows applications to access the functionality provided by the <a href="/wiki/Operating_system_shell.html" title="Operating system shell">operating system shell</a>, as well as change and enhance it. The component resides in <tt>shell.dll</tt> on 16-bit Windows, and <tt>shell32.dll</tt> and later in <a href="/wiki/Windows_95.html" title="Windows 95">Windows 95</a> <tt>shlwapi.dll</tt> on 32-bit Windows. It is grouped under the <i>User Interface</i> category of the API.</dd>
<dt>Network Services<sup id="_ref-msdn-network_0" class="reference"><a  title="">[9]</a></sup></dt>
<dd>Give access to the various <a href="/wiki/Computer_network.html" title="Computer network">networking</a> capabilities of the operating system. Its sub-components include <a href="/wiki/NetBIOS.html" title="NetBIOS">NetBIOS</a>, <a href="/wiki/Winsock.html" title="Winsock">Winsock</a>, <a href="/wiki/NetDDE.html" title="NetDDE">NetDDE</a>, <a href="/wiki/Remote_procedure_call.html" title="Remote procedure call">RPC</a> and many others.</dd>
</dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Web related APIs">edit</a>]</div>
<p><a name="Web_related_APIs" id="Web_related_APIs"></a></p>
<h3>Web related APIs</h3>
<p>The <a href="/wiki/Internet_Explorer.html" title="Internet Explorer">Internet Explorer</a> web browser also exposes many APIs that are often used by applications, and as such could be considered a part of the Windows API. Internet Explorer has been an integrated component of the operating system since <a href="/wiki/Windows_98.html" title="Windows 98">Windows 98</a>, and provides web related services to applications<sup id="_ref-msdn-browser_0" class="reference"><a  title="">[10]</a></sup>. The integration will stop with <a href="/wiki/Windows_Vista.html" title="Windows Vista">Windows Vista</a>. Specifically, it provides:</p>
<ul>
<li>An embeddable web browser control, contained in <tt>shdocvw.dll</tt> and <tt>mshtml.dll</tt>.</li>
<li>The URL monikers service, held in <tt>urlmon.dll</tt>, which provides COM objects to applications for resolving URLs. Applications can also provide their own URL handlers for others to use.</li>
<li>A library for assisting with multi-language and international text support (mlang.dll).</li>
<li>DirectX Transforms, a set of image filter components.</li>
<li>XML support (the MSXML components).</li>
<li>Access to the Windows Address Book.</li>
</ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Multimedia related APIs">edit</a>]</div>
<p><a name="Multimedia_related_APIs" id="Multimedia_related_APIs"></a></p>
<h3>Multimedia related APIs</h3>
<p>Microsoft has provided the <a href="/wiki/DirectX.html" title="DirectX">DirectX</a> set of APIs as part of every Windows installation. DirectX provides a loosely related set of multimedia and gaming services, including:</p>
<ul>
<li><a href="/wiki/Direct3D.html" title="Direct3D">Direct3D</a> as an alternative to OpenGL for access to 3D acceleration hardware.</li>
<li><a href="/wiki/DirectDraw.html" title="DirectDraw">DirectDraw</a> for hardware accelerated access to the 2D framebuffer. As of DirectX 9, this component has been deprecated in favor of Direct3D, which provides more general high-performance graphics functionality (2D rendering, after all, is really just a subset of 3D rendering).</li>
<li><a href="/wiki/DirectSound.html" title="DirectSound">DirectSound</a> for low level hardware accelerated sound card access.</li>
<li><a href="/wiki/DirectInput.html" title="DirectInput">DirectInput</a> for communication with input devices such as joysticks and gamepads.</li>
<li><a href="/wiki/DirectPlay.html" title="DirectPlay">DirectPlay</a> as a multiplayer gaming infrastructure. This component has been deprecated as of DirectX 9 and Microsoft no longer recommends its use for game development.</li>
<li><a href="/wiki/DirectShow.html" title="DirectShow">DirectShow</a> which builds and runs generic multimedia pipelines. It is comparable to the <a href="/wiki/GStreamer.html" title="GStreamer">GStreamer</a> framework and is often used to render in-game videos and build media players (<a href="/wiki/Windows_Media_Player.html" title="Windows Media Player">Windows Media Player</a> is based upon it). DirectShow is no longer recommended for game development.</li>
<li><a href="/wiki/DirectMusic.html" title="DirectMusic">DirectMusic</a></li>
</ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: APIs for interaction between programs">edit</a>]</div>
<p><a name="APIs_for_interaction_between_programs" id="APIs_for_interaction_between_programs"></a></p>
<h3>APIs for interaction between programs</h3>
<p>The Windows API mostly concerns itself with the interaction between the Operating System and an application. For communication between the different Windows applications among themselves, Microsoft has developed a series of technologies alongside the main Windows API. This started out with <a href="/wiki/Dynamic_Data_Exchange.html" title="Dynamic Data Exchange">Dynamic Data Exchange</a> (DDE), which was superseded by <a href="/wiki/Object_Linking_and_Embedding.html" title="Object Linking and Embedding">Object Linking and Embedding</a> (OLE) and later by the <a href="/wiki/Component_Object_Model.html" title="Component Object Model">Component Object Model</a> (COM).</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Wrapper Libraries">edit</a>]</div>
<p><a name="Wrapper_Libraries" id="Wrapper_Libraries"></a></p>
<h3>Wrapper Libraries</h3>
<p>Various <a href="/wiki/Wrapper.html" title="Wrapper">wrappers</a> were developed by Microsoft that took over some of the more low level functions of the Windows API, and allowed applications to interact with the API in a more abstract manner. <a href="/wiki/Microsoft_Foundation_Classes.html" title="Microsoft Foundation Classes">Microsoft Foundation Classes</a> (MFC) wrapped Windows API functionality in <a href="/wiki/C%2B%2B.html" title="C++">C++</a> <a href="/wiki/Class_%28computer_science%29.html" title="Class (computer science)">classes</a>, and thus allows a more <a href="/wiki/Object-oriented_programming.html" title="Object-oriented programming">object oriented</a> way of interacting with the API. The Active Template Library (ATL) is a <a href="/wiki/Template.html" title="Template">template</a> oriented wrapper for COM. The <a href="/wiki/Windows_Template_Library.html" title="Windows Template Library">Windows Template Library</a> (WTL) was developed as an extension to ATL, and intended as a lightweight alternative to MFC.</p>
<p>Also notable are some of <a href="/wiki/Borland.html" title="Borland">Borland's</a> offerings. <a href="/wiki/Object_Windows_Library.html" title="Object Windows Library">Object Windows Library</a> (OWL) was released as a competing product to MFC, and offered a similar object-oriented wrapper. Borland later <a href="/wiki/Deprecation.html" title="Deprecation">deprecated</a> it in favour of the <a href="/wiki/Visual_Component_Library.html" title="Visual Component Library">Visual Component Library</a> (VCL).</p>
<p>All <a href="/wiki/Application_framework.html" title="Application framework">application frameworks</a> for Windows are (at least partially) wrapping the Windows API. Thus, the <a href="/wiki/.NET_Framework.html" title=".NET Framework">.NET Framework</a> and <a href="/wiki/Java_programming_language.html" title="Java programming language">Java</a>, as well as any other <a href="/wiki/Programming_languages.html" title="Programming languages">programming languages</a> under Windows, are (or contain) Wrapper Libraries.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: History">edit</a>]</div>
<p><a name="History" id="History"></a></p>
<h2>History</h2>
<p>The Windows API has always exposed a large part of the underlying structure of the various Windows systems for which it has been built to the programmer. This has had the advantage of giving Windows programmers a great deal of flexibility and power over their applications. However, it also has given Windows applications a great deal of responsibility in handling various low-level, sometimes tedious, operations that are associated with a <a href="/wiki/Graphical_user_interface.html" title="Graphical user interface">Graphical user interface</a>.</p>
<p><a href="/wiki/Charles_Petzold.html" title="Charles Petzold">Charles Petzold</a>, writer of well-read Windows API books, has said:<sup id="_ref-petzold-47_0" class="reference"><a  title="">[11]</a></sup></p>
<blockquote class="toccolours" style="float:none; padding: 10px 15px 10px 15px;">
<p>The original hello-world program in the Windows 1.0 SDK was a bit of a scandal. HELLO.C was about 150 lines long, and the HELLO.RC resource script had another 20 or so more lines. (...) Veteran C programmers often curled up in horror or laughter when encountering the Windows hello-world program.</p>
<p style="text-align: right;"><cite style="font-style:normal;">— <a href="/wiki/Charles_Petzold.html" title="Charles Petzold">Charles Petzold</a>, <i>Programming Microsoft Windows with C#</i></cite></p>
</blockquote>
<p>A <a href="/wiki/List_of_hello_world_programs#Windows_API_.28in_C.29.html" title="List of hello world programs">hello world program</a> is a frequently used programming example, usually designed to show the easiest possible application on a system that can actually do something (i.e. print a line that says "Hello World").</p>
<p>Over the years, various changes and additions were made to the Windows Operating System, and the Windows API changed and grew to reflect this. The Windows API for <a href="/wiki/Windows_1.0.html" title="Windows 1.0">Windows 1.0</a> supported fewer than 450 <a href="/wiki/Subroutine.html" title="Subroutine">function calls</a>, where in modern versions of the Windows API there are thousands. However, in general, the interface remained fairly consistent, and an old Windows 1.0 application will still look familiar to a programmer who is used to the modern Windows API.<sup id="_ref-petzold-9_0" class="reference"><a  title="">[12]</a></sup></p>
<p>A large emphasis has been put by <a href="/wiki/Microsoft.html" title="Microsoft">Microsoft</a> on maintaining software <a href="/wiki/Backwards_compatibility.html" title="Backwards compatibility">backwards compatibility</a>. To achieve this, Microsoft sometime even went as far as supporting software that was using the API in a undocumented or even (programmatically) illegal way. <a href="/wiki/Raymond_Chen.html" title="Raymond Chen">Raymond Chen</a>, a Microsoft developer who works on the Windows API, has said that he:<sup id="_ref-chen-bozos_0" class="reference"><a  title="">[13]</a></sup></p>
<blockquote class="toccolours" style="float:none; padding: 10px 15px 10px 15px;">
<p>could probably write for months solely about bad things apps do and what we had to do to get them to work again (often in spite of themselves). Which is why I get particularly furious when people accuse Microsoft of maliciously breaking applications during OS upgrades. If any application failed to run on Windows 95, I took it as a personal failure.</p>
<p style="text-align: right;"><cite style="font-style:normal;">— <a href="/wiki/Raymond_Chen.html" title="Raymond Chen">Raymond Chen</a>, <i>What about BOZOSLIVEHERE and TABTHETEXTOUTFORWIMPS?</i></cite></p>
</blockquote>
<p>One of the largest changes the Windows API underwent was the transition from Win16 (shipped in Windows 3.1 and older) to Win32 (Windows NT and Windows 95 and up). While <a href="/wiki/Win32.html" title="Win32">Win32</a> was originally introduced with <a href="/wiki/Windows_NT_3.1.html" title="Windows NT 3.1">Windows NT 3.1</a> and <a href="/wiki/Win32s.html" title="Win32s">Win32s</a> allowed usage of a Win32 subset before Windows 95, it was not until Windows 95 that many applications began being ported to Win32. To ease the transition, in Windows 95, both for external developers and for Microsoft itself, a complex scheme of API <a href="/wiki/Thunk.html" title="Thunk">thunks</a> was used that could allow 32 bit code to call into 16 bit code and (in limited cases) vice-versa. So-called <i>flat thunks</i> allowed 32 bit code to call into 16 bit libraries, and the scheme was used extensively inside Windows 95 to avoid porting the whole OS to Win32 itself in one chunk. In Windows NT, the OS was pure 32-bit (except the parts for compatibility with 16-bit applications) and the only thunk available was generic thunks which only thunks from Win16 to Win32 and worked in Windows 95 too. The Platform SDK shipped with a compiler that could produce the code necessary for these thunks.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Versions">edit</a>]</div>
<p><a name="Versions" id="Versions"></a></p>
<h2>Versions</h2>
<p>Almost every new version of Microsoft Windows has introduced its own additions and changes to the Windows API. <sup id="_ref-win32faq-history_0" class="reference"><a  title="">[14]</a></sup> The name of the API however was kept consistent between different Windows version, and name changes were kept limited to major architectural and platform changes for Windows. Microsoft eventually changed the name of the then current Win32 API family into Windows API, and made it into a catch-all term for both past and future versions of the API. <sup id="_ref-msdn-overview2_0" class="reference"><a  title="">[15]</a></sup></p>
<ul>
<li><b>Win16</b> was the API for the first, <a href="/wiki/16-bit.html" title="16-bit">16-bit</a> versions of <a href="/wiki/Microsoft_Windows.html" title="Microsoft Windows">Microsoft Windows</a>. These were initially referred to as simply the Windows API, but were later renamed to Win16 in an effort to distinguish it from the newer, 32-bit version of the Windows API. The functions of Win16 API mainly reside in the core files of the OS: <i>kernel.exe</i> (or <i>krnl286.exe</i> or <i>krnl386.exe</i>), <i>user.exe</i> and <i>gdi.exe</i>. Despite the <a href="/wiki/File_extension.html" title="File extension">file extension</a> of <tt>exe</tt>, these actually are <a href="/wiki/Dynamically_linked_library.html" title="Dynamically linked library">dynamically linked libraries</a>.</li>
<li><b>Win32</b> is the <a href="/wiki/32-bit.html" title="32-bit">32-bit</a> <a href="/wiki/Application_programming_interface.html" title="Application programming interface">API</a> for modern versions of Windows. The API consists of functions implemented, as with Win16, in system DLLs. The core DLLs of Win32 are <a href="/wiki/Kernel32.dll.html" title="Kernel32.dll">kernel32.dll</a>, <a href="/wiki/User32.dll.html" title="User32.dll">user32.dll</a>, and <a  class="new" title="Gdi32.dll">gdi32.dll</a>. Win32 was introduced with <a href="/wiki/Windows_NT.html" title="Windows NT">Windows NT</a>. The version of Win32 that was shipped with <a href="/wiki/Windows_95.html" title="Windows 95">Windows 95</a> was initially referred to as Win32c, with the "c" standing for "compatibility", but this term was later abandoned by Microsoft in favour of Win32. In Windows NT 4.0 and its successors (including all modern Windows versions), Win32 calls are executed by two modules, csrss.exe (Client/Server Runtime Server Subsystem) in <a href="/wiki/User_mode.html" title="User mode">user mode</a> and win32k.sys in kernel mode. <sup id="_ref-architecture_0" class="reference"><a  title="">[16]</a></sup></li>
<li><b><a href="/wiki/Win32s.html" title="Win32s">Win32s</a></b> is an extension for the <a href="/wiki/Windows_3.x#Windows_3.1.html" title="Windows 3.x">Windows 3.1x</a> family of Microsoft Windows that implemented a <a href="/wiki/Subset.html" title="Subset">subset</a> of the Win32 API for these systems. The "s" stands for "subset".</li>
<li><b>Win32 for 64-bit Windows</b>, previously known as <b>Win64</b>, is the version of the API targeted for <a href="/wiki/64-bit.html" title="64-bit">64-bit</a> versions of Windows — namely, <a href="/wiki/Windows_XP_Professional_x64_Edition.html" title="Windows XP Professional x64 Edition">Windows XP Professional x64 Edition</a> and Windows Server 2003 x64 Edition (for <a href="/wiki/AMD64.html" title="AMD64">AMD64</a> processors) and Windows XP 64-bit Edition and Windows Server 2003 for <a href="/wiki/Itanium.html" title="Itanium">Itanium</a>-series. The 64-bit versions are just two more <a href="/wiki/Windows_NT#Supported_platforms.html" title="Windows NT">supported platforms</a> within <a href="/wiki/Architecture_of_the_Windows_NT_operating_system_line#Hardware_abstraction_layer.html" title="Architecture of the Windows NT operating system line">Windows NT architecture</a> so both 32-bit and 64-bit versions of an application can still be compiled from single <a href="/wiki/Code_base.html" title="Code base">code base</a>. All memory <a href="/wiki/Pointer.html" title="Pointer">pointers</a> are 64-bit by default though, so the source code has to be checked for compatibility with 64-bit <a href="/wiki/Pointer_arithmetic.html" title="Pointer arithmetic">pointer arithmetic</a> and rewritten as necessary. There are no new functions specific to 64-bit versions of Windows.</li>
</ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Other implementations">edit</a>]</div>
<p><a name="Other_implementations" id="Other_implementations"></a></p>
<h2>Other implementations</h2>
<p>Although Microsoft's implementation of the Windows API is copyrighted, it is generally accepted due to legal precendence in the United States that other vendors can emulate Windows by providing an identical API, without breaching copyright.</p>
<p>The <a href="/wiki/Wine_%28software%29.html" title="Wine (software)">Wine</a> project is an attempt to provide a Win32 API <a href="/wiki/Compatibility_layer.html" title="Compatibility layer">Compatibility layer</a> for <a href="/wiki/Unix-like.html" title="Unix-like">Unix-like</a> platforms. <a href="/wiki/ReactOS.html" title="ReactOS">ReactOS</a> goes a step further and provides an emulation of the entire Windows operating system, working closely with the Wine project to promote code re-use and compatibility. <a  class="external text" title="http://www.japheth.de/HX.html">HX DOS-Extender</a> (external link) is another project to emulate the Windows API, to allow running simple Windows programs from a <a href="/wiki/DOS.html" title="DOS">DOS</a> command line.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Compiler support">edit</a>]</div>
<p><a name="Compiler_support" id="Compiler_support"></a></p>
<h2>Compiler support</h2>
<p>To develop software that utilizes the Windows API, a compiler must be able to handle and import the Microsoft-specific DLLs and COM-objects. The compiler must accept a C or C++ language dialect and handle <a href="/wiki/Interface_description_language.html" title="Interface description language">IDL</a> (interface definition language) files and header files that expose the interior API function names. Collectively, these prerequisites (compilers, tools, libraries, and headers) are known as the <i><a href="/wiki/Microsoft_Platform_SDK.html" title="Microsoft Platform SDK">Microsoft Platform SDK</a>.</i> For a long time the proprietary <a href="/wiki/Microsoft_Visual_Studio.html" title="Microsoft Visual Studio">Microsoft Visual Studio</a> family of <a href="/wiki/Compiler.html" title="Compiler">compilers</a> and tools and <a href="/wiki/Borland.html" title="Borland">Borland</a>'s compilers were the only tools that could provide this (although at least in the case of Windows, the SDK itself is downloadable for free separately from the entire <a href="/wiki/IDE.html" title="IDE">IDE</a> suite, from <a  class="external text" title="http://www.microsoft.com/msdownload/platformsdk/sdkupdate/XPSP2FULLInstall.htm">Microsoft Platform SDK Update</a>). Nowadays the <a href="/wiki/MinGW.html" title="MinGW">MinGW</a> and <a href="/wiki/Cygwin.html" title="Cygwin">Cygwin</a> projects also provide such an environment based on the <a href="/wiki/GNU_Compiler_Collection.html" title="GNU Compiler Collection">GNU Compiler Collection</a>, using a stand-alone header file collection to make linking against Microsoft DLLs possible. <a href="/wiki/LCC-Win32.html" title="LCC-Win32">LCC-Win32</a> is a "free for non-commercial use" C compiler maintained by Jacob Navia (a comp.lang.c regular). <a href="/wiki/Pellesc.html" title="Pellesc">Pellesc</a> is a free C compiler maintained by Pelle Orinius. <a href="/wiki/MASM32.html" title="MASM32">MASM32</a> is a mature project to support the Windows API utilizing the 32 bit Microsoft assembler with custom made or converted headers and libraries from the Platform SDK.</p>
<p>Windows specific compiler support is also required for the <a href="/wiki/Exception_handling.html" title="Exception handling">Structured Exception Handling</a> feature (SEH). This system serves a dual purpose: it provides a substrate upon which language-specific exception handling can be implemented, and it is how the kernel notifies applications of exceptional conditions such as dereferencing an invalid pointer or stack overflow. The Microsoft/Borland C++ compilers had the ability to use this system as soon as it was introduced in Windows 95 and NT, however the actual implementation was undocumented and had to be reverse engineered for the Wine project and free compilers. SEH is based on pushing exception handler frames onto the stack, then adding them to a linked list stored in thread local storage (the first field of the thread environment block). When an exception is thrown, the kernel and base libraries unwind the stack running handlers and filters as they are encountered. Eventually, every exception unhandled by the application itself will be dealt with by the default backstop handler which pops up the Windows common crash dialog.</p>
<p>Example of API implementation in <a href="/wiki/Visual_Basic.html" title="Visual Basic">Visual Basic</a>: (this shortened example causes the Command button to be able to be moved around on the form by the user)</p>
<pre>
 Private Const WM_NCLBUTTONDOWN As Long = &amp;HA1&amp;
 Private Const HTCAPTION As Long = 2&amp;
 Private Declare Function ReleaseCapture Lib "user32" () As Long
 Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hWnd&amp;, ByVal wMsg&amp;, wParam As Any, lParam As Any) As Long
</pre>
<pre>
 If Command1.MousePointer = 14 Then
   Call ReleaseCapture
   Call SendMessage(Command1.hWnd, WM_NCLBUTTONDOWN, ByVal HTCAPTION, ByVal 0&amp;)
 End If
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: See also">edit</a>]</div>
<p><a name="See_also" id="See_also"></a></p>
<h2>See also</h2>
<ul>
<li><a href="/wiki/.NET_Framework_3.0.html" title=".NET Framework 3.0">.NET Framework 3.0</a></li>
<li><a href="/wiki/Win32_console.html" title="Win32 console">Win32 console</a></li>
<li><a href="/wiki/Interix.html" title="Interix">Interix</a></li>
<li><a  class="external text" title="http://www.ecma-international.org/publications/standards/Ecma-234.htm">ECMA-234</a> - <a href="/wiki/ECMA.html" title="ECMA">ECMA</a> standard for a subset of the Windows API</li>
</ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Notes">edit</a>]</div>
<p><a name="Notes" id="Notes"></a></p>
<h2>Notes</h2>
<ol class="references">
<li id="_note-msdn-overview"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (July 2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/overview_of_the_windows_api.asp">Overview of the Windows API.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-msdn-base"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (July 2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/base_services.asp">Base Services.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-msdn-gdi"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (July 2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/graphics_device_interface.asp">Graphics Device Interface.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-msdn-ui"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (July 2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/user_interface.asp">User Interface.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-msdn-comdlg"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/commondialogboxlibrary.asp">Common Dialog Box Library.</a></i> Retrieved September 22, 2005.</li>
<li id="_note-msdn-ccl"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (July 2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/common_control_library.asp">Common Control Library.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-msdn-shell"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (July 2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/windows_shell.asp">Windows Shell.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-msdn-shell2"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/programmersguide/shell_intro.asp">Shell Programmer's Guide.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-msdn-network"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (July 2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/network_services.asp">Network Services.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-msdn-browser"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (January 2006). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/workshop/browser/prog_browser_node_entry.asp">Programming and reusing the browser</a></i> Retrieved January 22, 2006.</li>
<li id="_note-petzold-47"><b><a  title="">^</a></b> <a href="/wiki/Charles_Petzold.html" title="Charles Petzold">Charles Petzold</a> (December 2001). <i>Programming Microsoft Windows with C#.</i> Microsoft Press. Beyond the Console, page 47.</li>
<li id="_note-petzold-9"><b><a  title="">^</a></b> <a href="/wiki/Charles_Petzold.html" title="Charles Petzold">Charles Petzold</a> (November 11, 1998). <i>Programming Windows, Fifth Edition.</i> Microsoft Press. APIs and Memory Models, page 9.</li>
<li id="_note-chen-bozos"><b><a  title="">^</a></b> <a href="/wiki/Raymond_Chen.html" title="Raymond Chen">Raymond Chen</a> (October 15, 2003). <i><a  class="external text" title="http://blogs.msdn.com/oldnewthing/archive/2003/10/15/55296.aspx">What about BOZOSLIVEHERE and TABTHETEXTOUTFORWIMPS?</a></i> Retrieved August 27, 2005.</li>
<li id="_note-win32faq-history"><b><a  title="">^</a></b> The Iseran Project (1996-2001). <i><a  class="external text" title="http://www.iseran.com/Win32/FAQ/history.html">History of the Windows API.</a></i> Retrieved October 7, 2005.</li>
<li id="_note-msdn-overview2"><b><a  title="">^</a></b> <a href="/wiki/Microsoft_Developer_Network.html" title="Microsoft Developer Network">Microsoft Developer Network</a> (July 2005). <i><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/overview_of_the_windows_api.asp">Overview of the Windows API.</a></i> Retrieved August 28, 2005.</li>
<li id="_note-architecture"><b><a  title="">^</a></b> <a href="/wiki/Architecture_of_the_Windows_NT_operating_system_line.html" title="Architecture of the Windows NT operating system line">Architecture of the Windows NT operating system line</a></li>
</ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: References">edit</a>]</div>
<p><a name="References" id="References"></a></p>
<h2>References</h2>
<ol>
<li><a href="/wiki/Diomidis_Spinellis.html" title="Diomidis Spinellis">Diomidis Spinellis</a>. <a  class="external text" title="http://www.spinellis.gr/pubs/jrnl/1997-CSI-WinApi/html/win.html">A critique of the Windows application programming interface</a>. <i>Computer Standards &amp; Interfaces</i>, 20(1):1–8, November 1998. <a  class="external text" title="http://dx.doi.org/10.1016/S0920-5489(98)00012-9">doi:10.1016/S0920-5489(98)00012-9</a>.</li>
</ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: External links">edit</a>]</div>
<p><a name="External_links" id="External_links"></a></p>
<h2>External links</h2>
<ul>
<li><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winprog/winprog/windows_api_start_page.asp">Microsoft Developer Network Windows API development guide</a></li>
<li><a  class="external text" title="http://blogs.msdn.com/oldnewthing/">The Old New Thing</a> Weblog by Microsoft developer <a href="/wiki/Raymond_Chen.html" title="Raymond Chen">Raymond Chen</a>, who works on the Windows API and posts extensively about it.</li>
<li><a  class="external text" title="http://wikibooks.org/wiki/Programming:Windows_Programming">Wikibooks:Windows Programming</a></li>
<li><a  class="external text" title="http://www.sysinternals.com/ntw2k/info/ntdll.shtml">Inside the Native API</a></li>
<li><a  class="external text" title="http://www.lingobit.com/solutions/win32/index.html">Localization in Win32</a></li>
<li><a  class="external text" title="http://pinvoke.net">pinvoke.net: the interop wiki!</a> PINVOKE.NET attempts to address the difficulty of calling Win32 or other unmanaged APIs in managed code (languages such as C# and VB .NET).</li>
<li><a  class="external text" title="http://www.cppworld.com/dante/winapinotes/index.htm">Windows API Notes</a></li>
</ul>
<ul>
<li><a  class="external text" title="http://www.stromcode.com/modules.php?name=Glowdot_Tutorials&amp;op=view&amp;tid=1">Stromcode's Win32/C++ tutorial</a> (formerly Glowdot) an extensive, 20-part tutorial.</li>
<li><a  class="external text" title="http://www.catch22.net/tuts/">Catch22 Tutorials</a> Well documented Win32 API tutorials for developing small, nifty, and efficient programs in Windows.</li>
<li><a  class="external text" title="http://www.winprog.net/tutorial/">theForger's Win32 API Tutorial</a></li>
</ul>
<ul>
<li><a  class="external text" title="http://www.news2news.com/vfp/">Using Win32 API in Visual FoxPro</a> online reference</li>
</ul>

<!-- 
Pre-expand include size: 1809 bytes
Post-expand include size: 1524 bytes
Template argument size: 892 bytes
Maximum: 2048000 bytes
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:81601-0!1!0!default!!en!2 and timestamp 20060910043856 -->
<div class="printfooter">
Retrieved from "<a </div>
			<div id="catlinks"><p class='catlinks'><a  title="Special:Categories">Categories</a>: <span dir='ltr'><a  title="Category:Application programming interfaces">Application programming interfaces</a></span> | <span dir='ltr'><a  title="Category:Microsoft APIs">Microsoft APIs</a></span></p></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<ul>
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/Windows_API.html">Article</a></li>
				 <li id="ca-talk"><a >Discussion</a></li>
				 <li id="ca-edit"><a >Edit this page</a></li>
				 <li id="ca-history"><a >History</a></li>
		</ul>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a >Sign in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/images/wiki-en.png);" href="/wiki/Main_Page.html" title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="/wiki/Main_Page.html">Main Page</a></li>
				<li id="n-portal"><a >Community Portal</a></li>
				<li id="n-Featured-articles"><a >Featured articles</a></li>
				<li id="n-currentevents"><a >Current events</a></li>
				<li id="n-recentchanges"><a >Recent changes</a></li>
				<li id="n-randompage"><a >Random article</a></li>
				<li id="n-help"><a >Help</a></li>
				<li id="n-contact"><a >Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a >Donations</a></li>
			</ul>
		</div>
	</div>
		<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/wiki/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a >What links here</a></li>
				<li id="t-recentchangeslinked"><a >Related changes</a></li>
<li id="t-upload"><a >Upload file</a></li>
<li id="t-specialpages"><a >Special pages</a></li>
				<li id="t-print"><a >Printable version</a></li>				<li id="t-permalink"><a >Permanent link</a></li><li id="t-cite"><a >Cite this article</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>In other languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-be"><a >Беларуская</a></li>
				<li class="interwiki-da"><a >Dansk</a></li>
				<li class="interwiki-de"><a >Deutsch</a></li>
				<li class="interwiki-es"><a >Español</a></li>
				<li class="interwiki-it"><a >Italiano</a></li>
				<li class="interwiki-ja"><a >日本語</a></li>
				<li class="interwiki-pl"><a >Polski</a></li>
				<li class="interwiki-ru"><a >Русский</a></li>
				<li class="interwiki-sv"><a >Svenska</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a ><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="MediaWiki" /></a></div>
				<div id="f-copyrightico"><a ><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
				<li id="lastmod"> This page was last modified 04:33, 10 September 2006.</li>
				<li id="copyright">All text is available under the terms of the <a class='internal'  title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal'  title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the Wikimedia Foundation, Inc.<br /></li>
				<li id="privacy"><a  title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li id="about"><a  title="Wikipedia:About">About Wikipedia</a></li>
				<li id="disclaimer"><a  title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
		
	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served by srv43 in 0.106 secs. --></body></html>

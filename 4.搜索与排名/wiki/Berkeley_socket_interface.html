<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="Berkeley sockets,1983,1989,AF INET,AT&amp;T,Abstraction (computer science),Application programming interface,Berkeley Software Distribution,C programming language,Computer network,Connectionless" />
<link rel="shortcut icon"  />
<link rel="search" type="application/opensearchdescription+xml"  />
<link rel="copyright"  />
		<title>Berkeley sockets - Wikipedia, the free encyclopedia</title>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "/skins-1.5/monobook/main.css?9"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print"  />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins-1.5/monobook/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/skins-1.5/monobook/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/skins-1.5/monobook/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/skins-1.5/monobook/IE70Fixes.css?1";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">
			var skin = "monobook";
			var stylepath = "/skins-1.5";

			var wgArticlePath = "/wiki/$1";
			var wgScriptPath = "/w";
			var wgServer = "http://en.wikipedia.org";
                        
			var wgCanonicalNamespace = "";
			var wgNamespaceNumber = 0;
			var wgPageName = "Berkeley_sockets";
			var wgTitle = "Berkeley sockets";
			var wgArticleId = 85068;
			var wgIsArticle = true;
                        
			var wgUserName = null;
			var wgUserLanguage = "en";
			var wgContentLanguage = "en";
		</script>
		                
		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?1"><!-- wikibits js --></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
@import "/w/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
@import "/w/index.php?title=-&action=raw&gen=css&maxage=2678400";
/*]]>*/</style>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js"></script>
	</head>
<body  class="mediawiki ns-0 ltr">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><div style="text-align:right; font-size:80%">Your <b><a  class="extiw" title="wikimedia:Fundraising">continued donations</a></b> keep Wikipedia running!&nbsp;&nbsp;&nbsp;&nbsp;</div>
</div>		<h1 class="firstHeading">Berkeley sockets</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub">(Redirected from <a  title="Berkeley socket interface">Berkeley socket interface</a>)</div>
									<div id="jump-to-nav">Jump to: <a >navigation</a>, <a >search</a></div>			<!-- start content -->
			<p>The <b>Berkeley sockets</b> <a href="/wiki/Application_programming_interface.html" title="Application programming interface">application programming interface</a> (API) comprises a <a href="/wiki/Library_%28computing%29.html" title="Library (computing)">library</a> for developing applications in the <a href="/wiki/C_programming_language.html" title="C programming language">C programming language</a> that perform <a href="/wiki/Inter-process_communication.html" title="Inter-process communication">inter-process communication</a>, most commonly across a <a href="/wiki/Computer_network.html" title="Computer network">computer network</a>.</p>
<p>Berkeley sockets (also known as the <a href="/wiki/Berkeley_Software_Distribution.html" title="Berkeley Software Distribution">BSD</a> socket API) originated with the 4.2BSD <a href="/wiki/Unix.html" title="Unix">Unix</a> <a href="/wiki/Operating_system.html" title="Operating system">operating system</a> (released in <a href="/wiki/1983.html" title="1983">1983</a>) as an API. Only in <a href="/wiki/1989.html" title="1989">1989</a>, however, could <a href="/wiki/UC_Berkeley.html" title="UC Berkeley">UC Berkeley</a> release versions of its operating system and networking library free from the licensing constraints of <a href="/wiki/AT%26T.html" title="AT&amp;T">AT&amp;T</a>'s copyright-protected Unix.</p>
<p>The Berkeley socket API forms the <i><a href="/wiki/De_facto.html" title="De facto">de facto</a></i> standard <a href="/wiki/Abstraction_%28computer_science%29.html" title="Abstraction (computer science)">abstraction</a> for network <a href="/wiki/Socket.html" title="Socket">sockets</a>. Most other programing languages use an interface similar to the C API.</p>
<p>The <a href="/wiki/Streams_%28networking_API%29.html" title="Streams (networking API)">STREAMS</a>-based <a href="/wiki/Transport_Layer_Interface.html" title="Transport Layer Interface">Transport Layer Interface</a> (TLI) API offers an alternative to the socket API. However, the Berkeley socket API predominates convincingly in popularity and in the number of implementations.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a ><span class="tocnumber">1</span> <span class="toctext">Berkeley socket interface</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">2</span> <span class="toctext">The header files</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">3</span> <span class="toctext">TCP</span></a>
<ul>
<li class="toclevel-2"><a ><span class="tocnumber">3.1</span> <span class="toctext">Server</span></a></li>
<li class="toclevel-2"><a ><span class="tocnumber">3.2</span> <span class="toctext">Client</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a ><span class="tocnumber">4</span> <span class="toctext">UDP</span></a>
<ul>
<li class="toclevel-2"><a ><span class="tocnumber">4.1</span> <span class="toctext">Server</span></a></li>
<li class="toclevel-2"><a ><span class="tocnumber">4.2</span> <span class="toctext">Client</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a ><span class="tocnumber">5</span> <span class="toctext">Functions</span></a>
<ul>
<li class="toclevel-2"><a ><span class="tocnumber">5.1</span> <span class="toctext">socket()</span></a>
<ul>
<li class="toclevel-3"><a ><span class="tocnumber">5.1.1</span> <span class="toctext">Prototype:</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a ><span class="tocnumber">5.2</span> <span class="toctext">gethostbyname() and gethostbyaddr()</span></a>
<ul>
<li class="toclevel-3"><a ><span class="tocnumber">5.2.1</span> <span class="toctext">Prototypes:</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a ><span class="tocnumber">5.3</span> <span class="toctext">connect()</span></a>
<ul>
<li class="toclevel-3"><a ><span class="tocnumber">5.3.1</span> <span class="toctext">Prototype:</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a ><span class="tocnumber">5.4</span> <span class="toctext">bind()</span></a>
<ul>
<li class="toclevel-3"><a ><span class="tocnumber">5.4.1</span> <span class="toctext">Prototype:</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a ><span class="tocnumber">5.5</span> <span class="toctext">listen()</span></a>
<ul>
<li class="toclevel-3"><a ><span class="tocnumber">5.5.1</span> <span class="toctext">Prototype:</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a ><span class="tocnumber">5.6</span> <span class="toctext">accept()</span></a>
<ul>
<li class="toclevel-3"><a ><span class="tocnumber">5.6.1</span> <span class="toctext">Prototype:</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a ><span class="tocnumber">6</span> <span class="toctext">Blocking vs. nonblocking</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">7</span> <span class="toctext">Cleaning up</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">8</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a ><span class="tocnumber">9</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<p><script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script></p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Berkeley socket interface">edit</a>]</div>
<p><a name="Berkeley_socket_interface" id="Berkeley_socket_interface"></a></p>
<h2>Berkeley socket interface</h2>
<p>The <b>Berkeley socket interface</b>, an <a href="/wiki/Application_programming_interface.html" title="Application programming interface">API</a>, allows communications between <a href="/wiki/Server_%28computing%29.html" title="Server (computing)">hosts</a> or between processes on one computer, using the concept of a <i><a href="/wiki/Socket.html" title="Socket">socket</a></i>. It can work with many different <a href="/wiki/Input/output.html" title="Input/output">I/O</a> devices and <a href="/wiki/Device_driver.html" title="Device driver">drivers</a>, although support for these depends on the <a href="/wiki/Operating_system.html" title="Operating system">operating-system</a> implementation. This interface implementation is implicit for <a href="/wiki/Internet_protocol_suite.html" title="Internet protocol suite">TCP/IP</a>, and it is therefore one of the fundamental technologies underlying the <a href="/wiki/Internet.html" title="Internet">Internet</a>. It was first developed at the <a href="/wiki/University_of_California%2C_Berkeley.html" title="University of California, Berkeley">University of California, Berkeley</a> for use on Unix systems. All modern operating systems now have some implementation of the Berkeley socket interface, as it has become the standard interface for connecting to the Internet.</p>
<p>Programmers can make the socket interfaces accessible at three different levels, most powerfully and fundamentally at the <a href="/wiki/Raw_socket.html" title="Raw socket">RAW socket</a> level. Very few applications need the degree of control over outgoing communications that this provides, so RAW sockets support was intended to be available only on computers used for developing Internet-related technologies. In recent years, most operating systems have implemented support for it anyway, including <a href="/wiki/Microsoft_Windows.html" title="Microsoft Windows">Windows XP</a>.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: The header files">edit</a>]</div>
<p><a name="The_header_files" id="The_header_files"></a></p>
<h2>The header files</h2>
<p>The Berkeley socket development library has many associated <code>header files</code>. They include:</p>
<dl>
<dd>
<dl>
<dt><code>&lt;sys/socket.h&gt;</code></dt>
<dd>Definitions for the most basic of socket structures with the BSD socket API</dd>
<dt><code>&lt;sys/types.h&gt;</code></dt>
<dd>Basic data types associated with structures within the BSD socket API</dd>
<dt><code>&lt;netinet/in.h&gt;</code></dt>
<dd>Definitions for the socketaddr_in{} and other base data structures.</dd>
<dt><code>&lt;sys/un.h&gt;</code></dt>
<dd>Definitions and data type declarations for SOCK_UNIX streams</dd>
</dl>
</dd>
</dl>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: TCP">edit</a>]</div>
<p><a name="TCP" id="TCP"></a></p>
<h2>TCP</h2>
<p><a href="/wiki/Transmission_Control_Protocol.html" title="Transmission Control Protocol">TCP</a> provides the concept of a connection. A process creates a TCP socket by calling the <code>socket()</code> function with the parameters <code><a href="/wiki/PF_INET.html" title="PF INET">PF_INET</a></code> or <code>PF_INET6</code> and <code>SOCK_STREAM</code>.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Server">edit</a>]</div>
<p><a name="Server" id="Server"></a></p>
<h3>Server</h3>
<p>Setting up a simple TCP server involves the following steps:</p>
<ul>
<li>Creating a TCP socket, with a call to <code>socket()</code>.</li>
<li>Binding the socket to the listen port, with a call to <code>bind()</code>. Before calling <code>bind()</code>, a programmer must declare a <code>sockaddr_in</code> structure, clear it (with <code>bzero()</code> or <code>memset()</code>), and the <code>sin_family</code> (<code>AF_INET</code> or <code>AF_INET6</code>), and fill its <code>sin_port</code> (the listening port, in <a href="/wiki/Network_byte_order.html" title="Network byte order">network byte order</a>) fields. Converting a <code>short int</code> to network byte order can be done by calling the function <code>htons()</code> (host to network short).</li>
<li>Preparing the socket to listen for connections (making it a listening socket), with a call to <code>listen()</code>.</li>
<li>Accepting incoming connections, via a call to <code>accept()</code>. This blocks until an incoming connection is received, and then returns a socket descriptor for the accepted connection. The initial descriptor remains a listening descriptor, and <code>accept()</code> can be called again at any time with this socket, until it is closed.</li>
<li>Communicating with the remote host, which can be done through <code>send()</code> and <code>recv()</code>.</li>
<li>Eventually closing each socket that was opened, once it is no longer needed, using <code>close()</code>. Note that if there were any calls to <code>fork()</code>, each process must close the sockets it knew about (the kernel keeps track of how many processes have a descriptor open), and two processes should not use the same socket at once.</li>
</ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Client">edit</a>]</div>
<p><a name="Client" id="Client"></a></p>
<h3>Client</h3>
<p>Setting up a TCP client involves the following steps:</p>
<ul>
<li>Creating a TCP socket, with a call to <code>socket()</code>.</li>
<li>Connecting to the server with the use of <code>connect</code>, passing a <code>sockaddr_in</code> structure with the <code>sin_family</code> set to <code><a href="/wiki/AF_INET.html" title="AF INET">AF_INET</a></code> or <code>AF_INET6</code>, <code>sin_port</code> set to the port the endpoint is listening (in network byte order), and <code>sin_addr</code> set to the IPv4 or IPv6 address of the listening server (also in network byte order.)</li>
<li>Communicating with the server by <code>send()</code>ing and <code>recv()</code>ing.</li>
<li>Terminating the connection and cleaning up with a call to <code>close()</code>. Again, if there were any calls to <code>fork()</code>, each process must <code>close()</code> the socket.</li>
</ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: UDP">edit</a>]</div>
<p><a name="UDP" id="UDP"></a></p>
<h2>UDP</h2>
<p><a href="/wiki/User_Datagram_Protocol.html" title="User Datagram Protocol">UDP</a> consists of a <a href="/wiki/Connectionless.html" title="Connectionless">connectionless</a> protocol with no guarantee of delivery. UDP packets may arrive out of order, become duplicated and arrive more than once, or even not arrive at all. Due to the minimal guarantees involved, UDP has considerably less overhead than TCP. Being connectionless means that there is no concept of a stream or connection between two hosts, instead, data arrives in datagrams.</p>
<p>UDP address space, the space of UDP port numbers (in ISO terminology, the TSAPs), is completely disjoint from that of TCP ports.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Server">edit</a>]</div>
<p><a name="Server_2" id="Server_2"></a></p>
<h3>Server</h3>
<p>Code may set up a UDP server on port 7654 as follows:</p>
<pre>
sock = socket(PF_INET,SOCK_DGRAM,0); 

sa.sin_addr.s_addr = INADDR_ANY;
sa.sin_port = htons(7654);

bound = bind(sock,(struct sockaddr *)&amp;sa, sizeof(struct sockaddr));
if (bound &lt; 0)
    fprintf(stderr, "bind(): %s\n",strerror(errno));
listen(sock,3);
</pre>
<p><tt>bind()</tt> binds the socket to an address/port pair. <tt>listen()</tt> sets the length of the new connections queue.</p>
<pre>
while (1) {
    printf ("recv test....\n");
    recsize = recvfrom(sock, (void *)hz, 100, 0, (struct sockaddr *)&amp;sa, fromlen);
    printf ("recsize: %d\n ",recsize);
    if (recsize &lt; 0)
        fprintf(stderr, "%s\n", strerror(errno));
    sleep(1);
    printf("datagram: %s\n",hz);
}
</pre>
<p>This infinite loop receives any UDP datagrams to port 7654 using <tt>recvfrom()</tt>. It uses the parameters:</p>
<ul>
<li>socket</li>
<li>pointer to buffer for data</li>
<li>size of buffer</li>
<li>flags (same as in read or other receive socket function)</li>
<li>address struct of sending peer</li>
<li>length of address struct of sending peer.</li>
</ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Client">edit</a>]</div>
<p><a name="Client_2" id="Client_2"></a></p>
<h3>Client</h3>
<p>A simple demo to send an UDP packet containing "Hello World!" to address 127.0.0.1, port 7654 might look like this:</p>
<pre>
#include &lt;stdio.h&gt;
#include &lt;errno.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;netinet/in.h&gt;

int main(int argc, char *argv[])
{
  int sock;
  struct sockaddr_in sa;
  int bytes_sent, buffer_length;
  char buffer[200];
  
  sprintf(buffer, "Hello World!");
  buffer_length = strlen(buffer) + 1;
  
  sock = socket(PF_INET, SOCK_DGRAM, 0);
  
  sa.sin_family = AF_INET;
  sa.sin_addr.s_addr = htonl(0x7F000001);
  sa.sin_port = htons(7654);
  
  bytes_sent = sendto(sock, buffer, buffer_length, 0, &amp;sa, sizeof(struct sockaddr_in) );
  if(bytes_sent &lt; 0)
    printf("Error sending packet: %s\n", strerror(errno) );
  
  return 0;
}
</pre>
<p>In this code, <code>buffer</code> provides a pointer to the data to send, and <code>buffer_length</code> specifies the size of the buffer contents.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Functions">edit</a>]</div>
<p><a name="Functions" id="Functions"></a></p>
<h2>Functions</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: socket()">edit</a>]</div>
<p><a name="socket.28.29" id="socket.28.29"></a></p>
<h3>socket()</h3>
<p><code>socket()</code> creates an endpoint for communication and returns a <a href="/wiki/File_Descriptor.html" title="File Descriptor">descriptor</a>. <code>socket()</code> takes three arguments:</p>
<ul>
<li><var>domain</var>, which specifies the protocol family of the created socket. For example:
<ul>
<li><code>PF_INET</code> for network protocol <a href="/wiki/IPv4.html" title="IPv4">IPv4</a> or</li>
<li><code>PF_INET6</code> for <a href="/wiki/IPv6.html" title="IPv6">IPv6</a>).</li>
</ul>
</li>
<li><var>type</var>, one of:
<ul>
<li><code>SOCK_STREAM</code> (reliable stream-oriented service)</li>
<li><code>SOCK_DGRAM</code> (datagram service)</li>
<li><code>SOCK_SEQPACKET</code> (reliable sequenced packet service), or</li>
<li><code>SOCK_RAW</code> (raw protocols atop the network layer).</li>
</ul>
</li>
<li><var>protocol</var>, usually set to 0 to represent the default <a href="/wiki/Transport_protocol.html" title="Transport protocol">transport protocol</a> for the specified <var>domain</var> and <var>type</var> values (<a href="/wiki/Transmission_Control_Protocol.html" title="Transmission Control Protocol">TCP</a> for <code>PF_INET</code> or <code>PF_INET6</code> and <code>SOCK_STREAM</code>, <a href="/wiki/User_Datagram_Protocol.html" title="User Datagram Protocol">UDP</a> for those <code>PF_</code> values and <code>SOCK_DGRAM</code>), but which can also explicitly specify a protocol.</li>
</ul>
<p>The function returns -1 if an error occurred. Otherwise, it returns an integer representing the newly-assigned descriptor.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Prototype:">edit</a>]</div>
<p><a name="Prototype:" id="Prototype:"></a></p>
<h4>Prototype:</h4>
<p><code>int socket(int domain, int type, int protocol);</code></p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: gethostbyname() and gethostbyaddr()">edit</a>]</div>
<p><a name="gethostbyname.28.29_and_gethostbyaddr.28.29" id="gethostbyname.28.29_and_gethostbyaddr.28.29"></a></p>
<h3>gethostbyname() and gethostbyaddr()</h3>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Prototypes:">edit</a>]</div>
<p><a name="Prototypes:" id="Prototypes:"></a></p>
<h4>Prototypes:</h4>
<p><code>struct hostent *gethostbyname(const char *name);</code></p>
<p><code>struct hostent *gethostbyaddr(const void *addr, int len, int type);</code></p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: connect()">edit</a>]</div>
<p><a name="connect.28.29" id="connect.28.29"></a></p>
<h3>connect()</h3>
<p><code>connect()</code> It returns an integer representing the error code: 0 represents success, while -1 represents an error.</p>
<p>Certain types of sockets are <i>connectionless</i>, most commonly user datagram protocol sockets. For these sockets, connect takes on a special meaning: the default target for sending and receiving data gets set to the given address, allowing the use of functions such as send() and recv() on connectionless sockets.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Prototype:">edit</a>]</div>
<p><a name="Prototype:_2" id="Prototype:_2"></a></p>
<h4>Prototype:</h4>
<p><code>int connect(int sockfd, const struct sockaddr *serv_addr, socklen_t addrlen);</code></p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: bind()">edit</a>]</div>
<p><a name="bind.28.29" id="bind.28.29"></a></p>
<h3>bind()</h3>
<p><code>bind()</code> assigns a socket an address. When a socket is created using <code>socket()</code>, it is given an address family, but not assigned an address. Before a socket may accept incoming connections, it must be bound. <code>bind()</code> takes three arguments:</p>
<ul>
<li><code>sockfd</code>, a descriptor representing the socket to perform the bind on</li>
<li><code>my_addr</code>, a pointer to a <code>sockaddr</code> structure representing the address to bind to.</li>
<li><code>addrlen</code>, a <code>socklen_t</code> field representing the length of the <code>sockaddr</code> structure.</li>
</ul>
<p>It returns 0 on success and -1 if an error occurs.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Prototype:">edit</a>]</div>
<p><a name="Prototype:_3" id="Prototype:_3"></a></p>
<h4>Prototype:</h4>
<p><code>int bind(int sockfd, struct sockaddr *my_addr, socklen_t addrlen);</code></p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: listen()">edit</a>]</div>
<p><a name="listen.28.29" id="listen.28.29"></a></p>
<h3>listen()</h3>
<p><code>listen()</code> prepares a bound socket to accept incoming connections. This function is only applicable to the <code>SOCK_STREAM</code> and <code>SOCK_SEQPACKET</code> socket types. It takes two arguments:</p>
<ul>
<li><code>sockfd</code>, a valid socket descriptor.</li>
<li><code>backlog</code>, an integer representing the number of pending connections that can be queued up at any one time. The operating system usually places a cap on this value.</li>
</ul>
<p>Once a connection is accepted, it is dequeued. On success, 0 is returned. If an error occurs, -1 is returned.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Prototype:">edit</a>]</div>
<p><a name="Prototype:_4" id="Prototype:_4"></a></p>
<h4>Prototype:</h4>
<p><code>int listen(int sockfd, int backlog);</code></p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: accept()">edit</a>]</div>
<p><a name="accept.28.29" id="accept.28.29"></a></p>
<h3>accept()</h3>
<p>Programmers use <code>accept()</code> to accept a connection request from a remote host. It takes the following arguments:</p>
<ul>
<li><code>sockfd</code>, the descriptor of the listening socket to accept the connection from.</li>
<li><code>cliaddr</code>, a pointer to the sockaddr structure that <code>accept()</code> should put the client's address information into.</li>
<li><code>addrlen</code>, a pointer to the <code>socklen_t</code> integer that will indicate to <code>accept()</code> how large the sockaddr structure pointed to by <code>cliaddr</code> is. When <code>accept()</code> returns, the <code>socklen_t</code> integer then indicates how many bytes of the <code>cliaddr</code> structure were actually used.</li>
</ul>
<p>The function returns a socket corresponding to the accepted connection, or -1 if an error occurs.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Prototype:">edit</a>]</div>
<p><a name="Prototype:_5" id="Prototype:_5"></a></p>
<h4>Prototype:</h4>
<p><code>int accept(int sockfd, struct sockaddr *cliaddr, socklen_t *addrlen);</code></p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Blocking vs. nonblocking">edit</a>]</div>
<p><a name="Blocking_vs._nonblocking" id="Blocking_vs._nonblocking"></a></p>
<h2>Blocking <i>vs.</i> nonblocking</h2>
<p>Berkeley sockets can operate in one of two modes: blocking or non-blocking. A <i>blocking</i> socket will not "return" until it has sent (or received) all the data specified for the operation. This may cause problems if a socket continues to listen: a program may hang as the socket waits for data that may never arrive.</p>
<p>A socket is typically set to blocking or nonblocking mode using the <code>fcntl()</code> or <code><a href="/wiki/Ioctl.html" title="Ioctl">ioctl</a>()</code> functions.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: Cleaning up">edit</a>]</div>
<p><a name="Cleaning_up" id="Cleaning_up"></a></p>
<h2>Cleaning up</h2>
<p>The system will not release the resources allocated by the <code>socket()</code> call until a <code>close()</code> call occurs. This is especially important if the <code>connect()</code> call fails and may be retried. Each call to <code>socket()</code> must have a matching call to <code>close()</code> in all possible execution paths.</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: See also">edit</a>]</div>
<p><a name="See_also" id="See_also"></a></p>
<h2>See also</h2>
<ul>
<li><a href="/wiki/Computer_network.html" title="Computer network">Computer network</a></li>
<li><a href="/wiki/Winsock.html" title="Winsock">Winsock</a>, the Berkeley sockets-based <a href="/wiki/Application_programming_interface.html" title="Application programming interface">application programming interface</a> for networking on <a href="/wiki/Microsoft_Windows.html" title="Microsoft Windows">Microsoft Windows</a></li>
</ul>
<div class="editsection" style="float:right;margin-left:5px;">[<a  title="Edit section: External links">edit</a>]</div>
<p><a name="External_links" id="External_links"></a></p>
<h2>External links</h2>
<ul>
<li><a  class="external text" title="http://foldoc.doc.ic.ac.uk/foldoc/foldoc.cgi?Unix+manual+pages">Unix Manual Pages:</a>
<ul>
<li><a  class="external text" title="http://www.die.net/doc/linux/man/man2/accept.2.html">accept(2)</a></li>
<li><a  class="external text" title="http://www.die.net/doc/linux/man/man2/connect.2.html">connect(2)</a></li>
</ul>
</li>
<li><a  class="external text" title="http://beej.us/guide/bgnet/">Beej's Guide to Network Programming</a></li>
<li><a  class="external text" title="http://www.developerweb.net/forum/index.php">UnixSocket FAQ</a></li>
<li><a  class="external text" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winsock/winsock/porting_socket_applications_to_winsock.asp">Porting Berkley Socket programs to Winsock</a></li>
</ul>
<p><span class="boilerplate" id="foldoc"><i>This article was originally based on material from the <a href="/wiki/Free_On-line_Dictionary_of_Computing.html" title="Free On-line Dictionary of Computing">Free On-line Dictionary of Computing</a>, which is <a  title="Wikipedia:Foldoc license">licensed</a> under the <a href="/wiki/GNU_Free_Documentation_License.html" title="GNU Free Documentation License">GFDL</a>.</i></span></p>


<!-- Saved in parser cache with key enwiki:pcache:idhash:85068-0!1!0!default!!en!2 and timestamp 20060910163158 -->
<div class="printfooter">
Retrieved from "<a </div>
			<div id="catlinks"><p class='catlinks'><a  title="Special:Categories">Categories</a>: <span dir='ltr'><a  title="Category:FOLDOC sourced articles">FOLDOC sourced articles</a></span> | <span dir='ltr'><a  title="Category:Network-related software">Network-related software</a></span> | <span dir='ltr'><a  title="Category:Application programming interfaces">Application programming interfaces</a></span> | <span dir='ltr'><a  title="Category:Inter-process communication">Inter-process communication</a></span></p></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<ul>
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/Berkeley_sockets.html">Article</a></li>
				 <li id="ca-talk"><a >Discussion</a></li>
				 <li id="ca-edit"><a >Edit this page</a></li>
				 <li id="ca-history"><a >History</a></li>
		</ul>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a >Sign in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/images/wiki-en.png);" href="/wiki/Main_Page.html" title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="/wiki/Main_Page.html">Main Page</a></li>
				<li id="n-portal"><a >Community Portal</a></li>
				<li id="n-Featured-articles"><a >Featured articles</a></li>
				<li id="n-currentevents"><a >Current events</a></li>
				<li id="n-recentchanges"><a >Recent changes</a></li>
				<li id="n-randompage"><a >Random article</a></li>
				<li id="n-help"><a >Help</a></li>
				<li id="n-contact"><a >Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a >Donations</a></li>
			</ul>
		</div>
	</div>
		<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/wiki/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a >What links here</a></li>
				<li id="t-recentchangeslinked"><a >Related changes</a></li>
<li id="t-upload"><a >Upload file</a></li>
<li id="t-specialpages"><a >Special pages</a></li>
				<li id="t-print"><a >Printable version</a></li>				<li id="t-permalink"><a >Permanent link</a></li><li id="t-cite"><a >Cite this article</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>In other languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-fr"><a >Français</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a ><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="MediaWiki" /></a></div>
				<div id="f-copyrightico"><a ><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
				<li id="lastmod"> This page was last modified 15:21, 17 August 2006.</li>
				<li id="copyright">All text is available under the terms of the <a class='internal'  title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal'  title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the Wikimedia Foundation, Inc.<br /></li>
				<li id="privacy"><a  title="wikimedia:Privacy policy">Privacy policy</a></li>
				<li id="about"><a  title="Wikipedia:About">About Wikipedia</a></li>
				<li id="disclaimer"><a  title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
		
	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served by srv82 in 0.172 secs. --></body></html>
